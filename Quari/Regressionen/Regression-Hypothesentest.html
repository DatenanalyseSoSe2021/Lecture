<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yilun" />

<meta name="date" content="2021-05-25" />

<title>Regressionen</title>

<script src="Regression-Hypothesentest_files/header-attrs-2.7/header-attrs.js"></script>
<script src="Regression-Hypothesentest_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Regression-Hypothesentest_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="Regression-Hypothesentest_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Regression-Hypothesentest_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Regression-Hypothesentest_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="Regression-Hypothesentest_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="Regression-Hypothesentest_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="Regression-Hypothesentest_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="Regression-Hypothesentest_files/navigation-1.1/tabsets.js"></script>
<link href="Regression-Hypothesentest_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="Regression-Hypothesentest_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div id="header">



<h1 class="title toc-ignore">Regressionen</h1>
<h4 class="author">Yilun</h4>
<h4 class="date">25 May 2021</h4>

</div>


<div id="regression" class="section level2">
<h2>Regression</h2>
<div id="loading-and-inspecting-data" class="section level3">
<h3>1 Loading and inspecting Data</h3>
<pre><code>## Rows: 88
## Columns: 10
## $ price    &lt;dbl&gt; 300.000, 370.000, 191.000, 195.000, 373.000, 466.275, 332.500…
## $ assess   &lt;dbl&gt; 349.1, 351.5, 217.7, 231.8, 319.1, 414.5, 367.8, 300.2, 236.1…
## $ bdrms    &lt;int&gt; 4, 3, 3, 3, 4, 5, 3, 3, 3, 3, 4, 5, 3, 3, 3, 4, 4, 3, 3, 4, 3…
## $ lotsize  &lt;dbl&gt; 6126, 9903, 5200, 4600, 6095, 8566, 9000, 6210, 6000, 2892, 6…
## $ sqrft    &lt;int&gt; 2438, 2076, 1374, 1448, 2514, 2754, 2067, 1731, 1767, 1890, 2…
## $ colonial &lt;int&gt; 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1…
## $ lprice   &lt;dbl&gt; 5.703783, 5.913503, 5.252274, 5.273000, 5.921578, 6.144775, 5…
## $ lassess  &lt;dbl&gt; 5.855359, 5.862210, 5.383118, 5.445875, 5.765504, 6.027073, 5…
## $ llotsize &lt;dbl&gt; 8.720297, 9.200593, 8.556414, 8.433811, 8.715224, 9.055556, 9…
## $ lsqrft   &lt;dbl&gt; 7.798934, 7.638198, 7.225482, 7.277938, 7.829630, 7.920810, 7…</code></pre>
</div>
<div id="a-first-regression" class="section level3">
<h3>2 A first regression</h3>
<pre class="r"><code>my.lm1 = lm(price~ sqrft, data = hprice1)
summary(my.lm1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = price ~ sqrft, data = hprice1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -117.112  -36.348   -6.503   31.701  235.253 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.20415   24.74261   0.453    0.652    
## sqrft        0.14021    0.01182  11.866   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 63.62 on 86 degrees of freedom
## Multiple R-squared:  0.6208, Adjusted R-squared:  0.6164 
## F-statistic: 140.8 on 1 and 86 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="using-predict-for-predictions" class="section level4">
<h4>2.1 Using predict for predictions</h4>
<pre class="r"><code>my.price.hat = predict(my.lm1)
head(my.price.hat)</code></pre>
<pre><code>##        1        2        3        4        5        6 
## 353.0385 302.2821 203.8540 214.2296 363.6945 397.3452</code></pre>
</div>
</div>
<div id="random-data-subsets" class="section level3">
<h3>3 Random data Subsets</h3>
<p>A simple way of obtaining a random sample is the following:</p>
<p>• First, reorder rows randomly</p>
<p>• Second, take (for example) the ﬁrst 80 percent of the rows</p>
<pre class="r"><code>my.random.index &lt;- sample(nrow(hprice1), replace = FALSE)
head(my.random.index)</code></pre>
<pre><code>## [1] 83 19 59 81 23 54</code></pre>
</div>
<div id="tasks" class="section level3">
<h3>4 Tasks</h3>
<div id="my.rss" class="section level4">
<h4>4.1 my.RSS</h4>
<p>Write a function my.RSS with two inputs: a string describing the formula and the dataset. The function carries out the regression and returns the RSS (residual sum of squares)</p>
<pre class="r"><code>my.RSS = function(my.str, my.data){
  sum(lm(my.str,data = my.data)$residuals^2)
}

#Testing
my.RSS(my.str = &quot;price~sqrft&quot;, my.data = hprice1)</code></pre>
<pre><code>## [1] 348053.4</code></pre>
</div>
<div id="my.data.select" class="section level4">
<h4>4.2 my.data.select</h4>
<p>Write a function that has two input arguments: a data and a number for the split (e.g. 0.8 for 80 percent). The function returns randomly selected training and test datasets</p>
<pre class="r"><code>my.data.select = function(my.data, split){
  nrow.train = round(nrow(my.data)*split,0)
  nrow.test = nrow(my.data)-nrow.train
  return(
    list(
      traindata = my.data[sample(nrow(my.data),nrow.train, replace = FALSE),],
      testdata = sample_n(my.data,nrow.test)
    )
  )
}</code></pre>
<pre><code>## List of 2
##  $ traindata:&#39;data.frame&#39;:   70 obs. of  10 variables:
##   ..$ price   : num [1:70] 325 295 280 247 330 ...
##   ..$ assess  : num [1:70] 437 318 336 240 360 ...
##   ..$ bdrms   : int [1:70] 4 3 4 3 3 4 3 3 3 3 ...
##   ..$ lotsize : num [1:70] 10859 6056 8460 9425 8178 ...
##   ..$ sqrft   : int [1:70] 2709 1837 1915 1440 2186 2438 1574 1502 2312 1662 ...
##   ..$ colonial: int [1:70] 0 1 1 1 1 1 0 0 1 1 ...
##   ..$ lprice  : num [1:70] 5.78 5.69 5.63 5.51 5.8 ...
##   ..$ lassess : num [1:70] 6.08 5.76 5.82 5.48 5.88 ...
##   ..$ llotsize: num [1:70] 9.29 8.71 9.04 9.15 9.01 ...
##   ..$ lsqrft  : num [1:70] 7.9 7.52 7.56 7.27 7.69 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;
##  $ testdata :&#39;data.frame&#39;:   18 obs. of  10 variables:
##   ..$ price   : num [1:18] 206 225 212 235 405 265 209 725 180 190 ...
##   ..$ assess  : num [1:18] 236 294 279 252 434 ...
##   ..$ bdrms   : int [1:18] 3 3 3 4 3 3 4 5 3 4 ...
##   ..$ lotsize : num [1:18] 6000 6003 6460 6383 12237 ...
##   ..$ sqrft   : int [1:18] 1767 1768 1899 1840 3375 1764 1674 3662 1812 1702 ...
##   ..$ colonial: int [1:18] 0 0 0 1 1 1 1 0 1 0 ...
##   ..$ lprice  : num [1:18] 5.33 5.42 5.36 5.46 6 ...
##   ..$ lassess : num [1:18] 5.46 5.68 5.63 5.53 6.07 ...
##   ..$ llotsize: num [1:18] 8.7 8.7 8.77 8.76 9.41 ...
##   ..$ lsqrft  : num [1:18] 7.48 7.48 7.55 7.52 8.12 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;</code></pre>
<pre class="r"><code># Testing 2
my.datasets &lt;- my.data.select(my.data = hprice1, split=0.8)
glimpse(my.datasets)</code></pre>
<pre><code>## List of 2
##  $ traindata:&#39;data.frame&#39;:   70 obs. of  10 variables:
##   ..$ price   : num [1:70] 250 471 209 714 242 ...
##   ..$ assess  : num [1:70] 268 482 289 655 252 ...
##   ..$ bdrms   : int [1:70] 3 5 4 5 4 4 3 3 5 4 ...
##   ..$ lotsize : num [1:70] 8410 15834 6400 28231 4950 ...
##   ..$ sqrft   : int [1:70] 1722 2617 1854 3331 1774 1674 1294 1768 2754 1840 ...
##   ..$ colonial: int [1:70] 1 1 1 1 1 1 0 0 1 1 ...
##   ..$ lprice  : num [1:70] 5.52 6.16 5.34 6.57 5.49 ...
##   ..$ lassess : num [1:70] 5.59 6.18 5.67 6.49 5.53 ...
##   ..$ llotsize: num [1:70] 9.04 9.67 8.76 10.25 8.51 ...
##   ..$ lsqrft  : num [1:70] 7.45 7.87 7.53 8.11 7.48 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;
##  $ testdata :&#39;data.frame&#39;:   18 obs. of  10 variables:
##   ..$ price   : num [1:18] 240 230 360 248 180 210 246 285 247 575 ...
##   ..$ assess  : num [1:18] 304 276 452 273 222 ...
##   ..$ bdrms   : int [1:18] 4 3 4 4 3 3 3 3 3 5 ...
##   ..$ lotsize : num [1:18] 5922 4054 10892 7050 6017 ...
##   ..$ sqrft   : int [1:18] 2000 1736 2750 1656 1812 1408 1662 1774 1440 3880 ...
##   ..$ colonial: int [1:18] 0 1 1 1 1 1 1 1 1 1 ...
##   ..$ lprice  : num [1:18] 5.48 5.44 5.89 5.51 5.19 ...
##   ..$ lassess : num [1:18] 5.72 5.62 6.11 5.61 5.4 ...
##   ..$ llotsize: num [1:18] 8.69 8.31 9.3 8.86 8.7 ...
##   ..$ lsqrft  : num [1:18] 7.6 7.46 7.92 7.41 7.5 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;</code></pre>
<pre class="r"><code>my.formula &lt;- as.formula(&quot;price ~ sqrft&quot;) 
my.lm2 &lt;- lm(my.formula, data=my.datasets$traindata)
summary(my.lm2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = my.formula, data = my.datasets$traindata)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -111.143  -36.631   -8.481   30.507  211.073 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -28.42692   29.24803  -0.972    0.335    
## sqrft         0.16135    0.01421  11.351   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 65.38 on 68 degrees of freedom
## Multiple R-squared:  0.6546, Adjusted R-squared:  0.6495 
## F-statistic: 128.9 on 1 and 68 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>predict.test &lt;- predict(my.lm2, newdata = my.datasets$testdata)
head(predict.test)</code></pre>
<pre><code>##        1        2        3        4        5        6 
## 294.2814 251.6839 415.2970 238.7755 263.9468 198.7597</code></pre>
</div>
<div id="my.rsstraintest" class="section level4">
<h4>4.3 my.RSSTrainTest</h4>
<p>Write a function that accepts a formula, a dataset and split as an input. It creates the training and test datasets, and runs the regression using the training dataset. Finally, it calculates the RSS for the training dataset and the test dataset.</p>
<pre class="r"><code># Write A function that calculates the Residual Sum of Squares
my.RSS.calculator = function(input.lm, x, y) {
  sum(
    (
      (input.lm$coefficients[1]+input.lm$coefficients[2]*x)
      - y
    )
    ^2
  )
}
#Testing
my.RSS.calculator(input.lm = lm(&quot;price~sqrft&quot;, data = hprice1),x = hprice1$sqrft,y=hprice1$price)</code></pre>
<pre><code>## [1] 348053.4</code></pre>
<pre class="r"><code>my.RSSTrainTest = function(formula,my.data,split){
  # create Datasets
  fn.dataset = my.data.select(my.data = my.data, split = split)
  ## subsetting 
  train.dataset = fn.dataset$traindata
  test.dataset = fn.dataset$testdata
  
  # get Model using traindata
  fn.lm = lm(formula, data = fn.dataset$traindata)
  
  # Use Make to make predictions
  train.dataset$prediction = predict(fn.lm)
  test.dataset$prediction = predict(fn.lm,newdata = test.dataset)
  
  # compute RSS
  list(
    rssTrain = my.RSS.calculator(input.lm = fn.lm,x = train.dataset$sqrft, y = train.dataset$price),
    rssTest = my.RSS.calculator(input.lm = fn.lm,x = test.dataset$sqrft, y = test.dataset$price)
  )
}

#Testing 
my.RSSTrainTest(&quot;price ~ sqrft&quot;, my.data=hprice1, split=0.8)</code></pre>
<pre><code>## $rssTrain
## [1] 256790.8
## 
## $rssTest
## [1] 53738.46</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
