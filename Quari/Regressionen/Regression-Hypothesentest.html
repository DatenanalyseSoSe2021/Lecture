<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yilun" />

<meta name="date" content="2021-05-25" />

<title>Regressionen</title>

<script src="Regression-Hypothesentest_files/header-attrs-2.7/header-attrs.js"></script>
<script src="Regression-Hypothesentest_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Regression-Hypothesentest_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="Regression-Hypothesentest_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Regression-Hypothesentest_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Regression-Hypothesentest_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="Regression-Hypothesentest_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="Regression-Hypothesentest_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="Regression-Hypothesentest_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="Regression-Hypothesentest_files/navigation-1.1/tabsets.js"></script>
<link href="Regression-Hypothesentest_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="Regression-Hypothesentest_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div id="header">



<h1 class="title toc-ignore">Regressionen</h1>
<h4 class="author">Yilun</h4>
<h4 class="date">25 May 2021</h4>

</div>


<div id="regression" class="section level2">
<h2>Regression</h2>
<div id="loading-and-inspectindg-data" class="section level3">
<h3>1 Loading and inspectindg Data</h3>
<pre class="r"><code>data(hprice1)
glimpse(hprice1)</code></pre>
<pre><code>## Rows: 88
## Columns: 10
## $ price    &lt;dbl&gt; 300.000, 370.000, 191.000, 195.000, 373.000, 466.275, 332.500…
## $ assess   &lt;dbl&gt; 349.1, 351.5, 217.7, 231.8, 319.1, 414.5, 367.8, 300.2, 236.1…
## $ bdrms    &lt;int&gt; 4, 3, 3, 3, 4, 5, 3, 3, 3, 3, 4, 5, 3, 3, 3, 4, 4, 3, 3, 4, 3…
## $ lotsize  &lt;dbl&gt; 6126, 9903, 5200, 4600, 6095, 8566, 9000, 6210, 6000, 2892, 6…
## $ sqrft    &lt;int&gt; 2438, 2076, 1374, 1448, 2514, 2754, 2067, 1731, 1767, 1890, 2…
## $ colonial &lt;int&gt; 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1…
## $ lprice   &lt;dbl&gt; 5.703783, 5.913503, 5.252274, 5.273000, 5.921578, 6.144775, 5…
## $ lassess  &lt;dbl&gt; 5.855359, 5.862210, 5.383118, 5.445875, 5.765504, 6.027073, 5…
## $ llotsize &lt;dbl&gt; 8.720297, 9.200593, 8.556414, 8.433811, 8.715224, 9.055556, 9…
## $ lsqrft   &lt;dbl&gt; 7.798934, 7.638198, 7.225482, 7.277938, 7.829630, 7.920810, 7…</code></pre>
</div>
<div id="a-first-regression" class="section level3">
<h3>2 A first regression</h3>
<pre class="r"><code>my.lm1 = lm(price~ sqrft, data = hprice1)
summary(my.lm1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = price ~ sqrft, data = hprice1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -117.112  -36.348   -6.503   31.701  235.253 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.20415   24.74261   0.453    0.652    
## sqrft        0.14021    0.01182  11.866   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 63.62 on 86 degrees of freedom
## Multiple R-squared:  0.6208, Adjusted R-squared:  0.6164 
## F-statistic: 140.8 on 1 and 86 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="using-predict-for-predictions" class="section level4">
<h4>2.1 Using predict for predictions</h4>
<pre class="r"><code>my.price.hat = predict(my.lm1)
head(my.price.hat)</code></pre>
<pre><code>##        1        2        3        4        5        6 
## 353.0385 302.2821 203.8540 214.2296 363.6945 397.3452</code></pre>
</div>
</div>
<div id="random-data-subsets" class="section level3">
<h3>3 Random data Subsets</h3>
<p>A simple way of obtaining a random sample is the following:</p>
<p>• First, reorder rows randomly</p>
<p>• Second, take (for example) the ﬁrst 80 percent of the rows</p>
<pre class="r"><code>my.random.index &lt;- sample(nrow(hprice1), replace = FALSE)
head(my.random.index)</code></pre>
<pre><code>## [1] 25 26 12 16 83  2</code></pre>
</div>
<div id="tasks" class="section level3">
<h3>4 Tasks</h3>
<div id="my.rss" class="section level4">
<h4>4.1 my.RSS</h4>
<p>Write a function my.RSS with two inputs: a string describing the formula and the dataset. The function carries out the regression and returns the RSS (residual sum of squares)</p>
<pre class="r"><code>my.RSS = function(my.str, my.data){
  sum(lm(my.str,data = my.data)$residuals^2)
}

#Testing
my.RSS(my.str = &quot;price~sqrft&quot;, my.data = hprice1)</code></pre>
<pre><code>## [1] 348053.4</code></pre>
</div>
<div id="my.data.select" class="section level4">
<h4>4.2 my.data.select</h4>
<p>Write a function that has two input arguments: a data and a number for the split (e.g. 0.8 for 80 percent). The function returns randomly selected training and test datasets</p>
<pre class="r"><code>my.data.select = function(my.data, split){
  nrow.train = round(nrow(my.data)*split,0)
  nrow.test = nrow(my.data)-nrow.train
  return(
    list(
      traindata = my.data[sample(nrow(my.data),nrow.train, replace = FALSE),],
      testdata = sample_n(my.data,nrow.test)
    )
  )
}</code></pre>
<pre class="r"><code># Testing 1
my.datasets = my.data.select(my.data = hprice1, split=0.8)
glimpse(my.datasets)</code></pre>
<pre><code>## List of 2
##  $ traindata:&#39;data.frame&#39;:   70 obs. of  10 variables:
##   ..$ price   : num [1:70] 236 310 360 180 471 ...
##   ..$ assess  : num [1:70] 259 254 452 222 482 ...
##   ..$ bdrms   : int [1:70] 3 6 4 3 5 3 2 4 4 3 ...
##   ..$ lotsize : num [1:70] 5828 5348 10892 6017 15834 ...
##   ..$ sqrft   : int [1:70] 1715 1386 2750 1812 2617 2106 2205 2066 2514 1374 ...
##   ..$ colonial: int [1:70] 0 1 1 1 1 1 0 1 1 0 ...
##   ..$ lprice  : num [1:70] 5.46 5.74 5.89 5.19 6.16 ...
##   ..$ lassess : num [1:70] 5.56 5.54 6.11 5.4 6.18 ...
##   ..$ llotsize: num [1:70] 8.67 8.58 9.3 8.7 9.67 ...
##   ..$ lsqrft  : num [1:70] 7.45 7.23 7.92 7.5 7.87 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;
##  $ testdata :&#39;data.frame&#39;:   18 obs. of  10 variables:
##   ..$ price   : num [1:18] 251 330 190 478 202 ...
##   ..$ assess  : num [1:18] 224 360 212 478 258 ...
##   ..$ bdrms   : int [1:18] 3 3 4 7 3 4 3 4 3 2 ...
##   ..$ lotsize : num [1:18] 5763 8178 3500 8400 6341 ...
##   ..$ sqrft   : int [1:18] 1630 2186 1702 3529 1574 2829 1932 1780 1662 1478 ...
##   ..$ colonial: int [1:18] 1 1 0 1 0 0 0 1 1 0 ...
##   ..$ lprice  : num [1:18] 5.53 5.8 5.25 6.17 5.31 ...
##   ..$ lassess : num [1:18] 5.41 5.88 5.36 6.17 5.55 ...
##   ..$ llotsize: num [1:18] 8.66 9.01 8.16 9.04 8.75 ...
##   ..$ lsqrft  : num [1:18] 7.4 7.69 7.44 8.17 7.36 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;</code></pre>
<pre class="r"><code># Testing 2
my.datasets &lt;- my.data.select(my.data = hprice1, split=0.8)
glimpse(my.datasets)</code></pre>
<pre><code>## List of 2
##  $ traindata:&#39;data.frame&#39;:   70 obs. of  10 variables:
##   ..$ price   : num [1:70] 206 370 195 240 230 ...
##   ..$ assess  : num [1:70] 236 352 232 251 267 ...
##   ..$ bdrms   : int [1:70] 3 3 3 3 3 5 3 3 4 4 ...
##   ..$ lotsize : num [1:70] 6000 9903 4600 6000 6710 ...
##   ..$ sqrft   : int [1:70] 1767 2076 1448 1536 1932 3331 1768 1899 2343 1854 ...
##   ..$ colonial: int [1:70] 0 1 1 1 0 1 0 0 0 1 ...
##   ..$ lprice  : num [1:70] 5.33 5.91 5.27 5.48 5.44 ...
##   ..$ lassess : num [1:70] 5.46 5.86 5.45 5.52 5.59 ...
##   ..$ llotsize: num [1:70] 8.7 9.2 8.43 8.7 8.81 ...
##   ..$ lsqrft  : num [1:70] 7.48 7.64 7.28 7.34 7.57 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;
##  $ testdata :&#39;data.frame&#39;:   18 obs. of  10 variables:
##   ..$ price   : num [1:18] 251 318 466 289 236 ...
##   ..$ assess  : num [1:18] 224 295 414 299 259 ...
##   ..$ bdrms   : int [1:18] 3 4 5 3 3 3 3 3 4 4 ...
##   ..$ lotsize : num [1:18] 5763 92681 8566 6060 5828 ...
##   ..$ sqrft   : int [1:18] 1630 1696 2754 1925 1715 1722 1768 1374 1915 1780 ...
##   ..$ colonial: int [1:18] 1 1 1 1 0 1 0 0 1 1 ...
##   ..$ lprice  : num [1:18] 5.53 5.76 6.14 5.67 5.46 ...
##   ..$ lassess : num [1:18] 5.41 5.69 6.03 5.7 5.56 ...
##   ..$ llotsize: num [1:18] 8.66 11.44 9.06 8.71 8.67 ...
##   ..$ lsqrft  : num [1:18] 7.4 7.44 7.92 7.56 7.45 ...
##   ..- attr(*, &quot;time.stamp&quot;)= chr &quot;25 Jun 2011 23:03&quot;</code></pre>
<pre class="r"><code>my.formula &lt;- as.formula(&quot;price ~ sqrft&quot;) 
my.lm2 &lt;- lm(my.formula, data=my.datasets$traindata)
summary(my.lm2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = my.formula, data = my.datasets$traindata)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -127.772  -36.905   -3.789   33.474  226.740 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.93117   27.73616    0.07    0.945    
## sqrft        0.14555    0.01319   11.03   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 68.05 on 68 degrees of freedom
## Multiple R-squared:  0.6416, Adjusted R-squared:  0.6364 
## F-statistic: 121.7 on 1 and 68 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>predict.test &lt;- predict(my.lm2, newdata = my.datasets$testdata)
head(predict.test)</code></pre>
<pre><code>##        1        2        3        4        5        6 
## 239.1787 248.7851 402.7777 282.1162 251.5505 252.5694</code></pre>
</div>
<div id="my.rsstraintest" class="section level4">
<h4>4.3 my.RSSTrainTest</h4>
<p>Write a function that accepts a formula, a dataset and split as an input. It creates the training and test datasets, and runs the regression using the training dataset. Finally, it calculates the RSS for the training dataset and the test dataset.</p>
<pre class="r"><code>my.RSS.calculator = function(input.lm, x, y) {
  sum(((input.lm$coefficients[1]+input.lm$coefficients[2]*x)-y)^2)
}
#Testing
my.RSS.calculator(input.lm = lm(&quot;price~sqrft&quot;, data = hprice1),x = hprice1$sqrft,y=hprice1$price)</code></pre>
<pre><code>## [1] 348053.4</code></pre>
<pre class="r"><code>my.RSSTrainTest = function(formula,my.data,split){
  # create Datasets
  fn.dataset = my.data.select(my.data = my.data, split = split)
  ## subsetting 
  train.dataset = fn.dataset$traindata
  test.dataset = fn.dataset$testdata
  
  # get Model using traindata
  fn.lm = lm(formula, data = fn.dataset$traindata)
  
  # Use Make to make predictions
  train.dataset$prediction = predict(fn.lm)
  test.dataset$prediction = predict(fn.lm,newdata = test.dataset)
  
  # compute RSS
  list(
    rssTrain = my.RSS.calculator(input.lm = fn.lm,x = train.dataset$sqrft, y = train.dataset$price),
    rssTest = my.RSS.calculator(input.lm = fn.lm,x = test.dataset$sqrft, y = test.dataset$price)
  )

}

#Testing 
my.RSSTrainTest(&quot;price ~ sqrft&quot;, my.data=hprice1, split=0.8)</code></pre>
<pre><code>## $rssTrain
## [1] 271654.1
## 
## $rssTest
## [1] 106927.7</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
